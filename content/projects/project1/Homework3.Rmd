---
title: "Session 6: Homework 3"
author: "Pietro Gobbi"
date: "`r Sys.Date()`"
output:
  html_document:
    theme: flatly
    highlight: zenburn
    number_sections: yes
    toc: yes
    toc_float: yes
    code_folding: show
---


```{r, setup, echo=FALSE}
knitr::opts_chunk$set(
  message = FALSE, 
  warning = FALSE, 
  tidy=FALSE,     # display code as typed
  size="small")   # slightly smaller font for code
options(digits = 3)

# default figure size
knitr::opts_chunk$set(
  fig.width=8, 
  fig.height=6.75,
  fig.align = "center"
)
```


```{r load-libraries, echo=FALSE}
library(tidyverse)  # Load ggplot2, dplyr, and all the other tidyverse packages
library(mosaic)
library(ggthemes)
library(GGally)
library(readxl)
library(here)
library(skimr)
library(janitor)
library(broom)
library(tidyquant)
library(infer)
library(openintro)
library(tidyquant)
```


# Youth Risk Behavior Surveillance

## Load the data

?yrbss

```{r}
data(yrbss)
glimpse(yrbss)
skim(yrbss)
```


## Exploratory Data Analysis

```{r, eda_on_weight}

Number_of_missing_weight <- count(yrbss,is.na(yrbss$weight))
Number_of_missing_weight[2,2]       ## take the number of missing weight only

temp <- yrbss%>%
  filter(weight != is.na(weight))     ## eliminate NAs to calculate summary statistics

mean.weight <- mean(temp$weight)
median.weight <- median(temp$weight)

summary <- yrbss %>%
  filter(!is.na(weight))%>%
  summarise(mean_weight = mean.weight , min_weight = min(weight), max = max(weight), median_weight = median.weight, sd_weights = sd(weights))
summary

ggplot(temp, aes(x= weight))+
  geom_density()+
  theme_bw()+
   geom_vline(xintercept = mean.weight, size = 0.5, colour = "red") +       #add mean line
    geom_vline(xintercept = median.weight, size = 0.5, colour = "green")+   #add median line
  geom_text(aes(x=mean.weight+8, label=paste0("Mean\n", round(mean.weight,2)), y=0.01))+
  geom_text(aes(x=median.weight-8, label=paste0("Median\n", round(median.weight,2)), y=0.02))+
  labs(title = "Distribution of weights", x="Weight", y="")
```

>We are missing 1004 values for weight. Based on our graph, median weight of the participants is at 64.41kg, while mean weight is at 67.91kg.


```{r}
temp <- yrbss %>%
  filter(!is.na(physically_active_7d),!is.na(weight))%>%
  group_by(physically_active_7d)

temp$physically_active_7d <- as.character(temp$physically_active_7d)
  

ggplot(temp, aes(x=weight, y=physically_active_7d))+
  geom_boxplot()+
  theme_bw()+
  labs(title="Weight vs Physical activity", x="Weight", y="Number of days with physical act. in the last 7")


```
>It seems that there is a positive correlation between weight and physical activity. High schooler's that had below 2 days of physical activity seem to have the lowest weight on average, while those that had 5 and above usually had higher weights. 

  
```{r}
yrbss <- yrbss %>% 
  mutate(physical_3plus = ifelse(physically_active_7d >= 3, "yes", "no"))

yrbss %>% filter(!is.na(physical_3plus)) %>% 
  group_by(physical_3plus) %>% 
  summarise(count = n()) %>% 
  mutate(prop= count/sum(count))


```

```{r}
physically_active_no = yrbss %>%
  filter(physical_3plus == "no")%>%
  summarise(count = n())

physically_active_total = yrbss %>%
  filter(!is.na(physical_3plus))%>%
  summarise(count = n())

prop.test(physically_active_no$count, physically_active_total$count)


```


```{r, boxplot}
temp <- yrbss%>%
  filter(!is.na(physical_3plus))

ggplot(temp, aes(x=weight, y=physical_3plus))+
  geom_boxplot()+
  theme_bw()+
  labs(title="Weight vs Physical activity", x="Weight", y="3 or more days with physical act. in the last 7?")
```
>This boxplot confirms our previous considerations about the correlation between weight and physical activity. We notice that 25th percentile, median and 75th percentile are higher for the group that answered "Yes" to the question asked.
It is clear that high schoolers that had 3 or more days of physical activity in the last week have higher weight on average than those who did not. 

## Confidence Interval


```{r}
yrbss %>%
  group_by(physical_3plus) %>%
  filter(!is.na(physical_3plus)) %>% 
  summarise(mean_weight = mean(weight, na.rm = TRUE),
            sd_weight = sd(weight, na.rm=TRUE),
            count = n(),
            se_weight = sd_weight/sqrt(count),
            t_critical = qt(0.975, count-1), 
            margin_of_error = t_critical * se_weight,
            lower = mean_weight - t_critical * se_weight,
            upper = mean_weight + t_critical * se_weight
            )

```

>There is an observed difference of about 1.77kg (68.44 - 66.67), and we notice that the two confidence intervals do not overlap. It seems that the difference is at least 95% statistically significant.

## Hypothesis test with formula

```{r}
t.test(weight ~ physical_3plus, data = yrbss)
```



## Hypothesis test with `infer`



```{r}
obs_diff <- yrbss %>%
  specify(weight ~ physical_3plus) %>%
  calculate(stat = "diff in means", order = c("yes", "no"))

```




```{r}
null_dist <- yrbss %>%
  specify(weight ~ physical_3plus) %>%
  hypothesize(null = "independence") %>%
  generate(reps = 1000, type = "permute") %>%
  calculate(stat = "diff in means", order = c("yes", "no"))

```



```{r}
ggplot(data = null_dist, aes(x = stat)) +
  geom_histogram()

```


```{r}

null_dist %>% visualize() +
  shade_p_value(obs_stat = obs_diff, direction = "two-sided")

null_dist %>%
  get_p_value(obs_stat = obs_diff, direction = "two_sided")

```



# IMDB ratings: Differences between directors




```{r directors, echo=FALSE, out.width="100%"}
knitr::include_graphics(here::here("images", "directors.png"), error = FALSE)
```



```{r load-movies-data}
movies <- read_csv(here::here("data", "movies.csv"))
glimpse(movies)
```



```{r}
movies_clean <- movies %>%      #clean data frame to have only Tim Burton and Spielberg movies
  filter(director=="Tim Burton"|director=="Steven Spielberg")

t.test(rating ~ director, data = movies_clean)

obs_diff_movies <- movies_clean %>%
  specify(rating ~ director) %>%
  calculate(stat = "diff in means", order = c("Steven Spielberg", "Tim Burton"))

null_dist <- movies_clean %>%
  specify(rating ~ director) %>%
  hypothesize(null = "independence") %>%
  generate(reps = 2000, type = "permute") %>%
  calculate(stat = "diff in means", order = c("Steven Spielberg", "Tim Burton")) # create null distribution

null_dist %>% visualize() +
  shade_p_value(obs_stat = obs_diff_movies, direction = "two-sided")

null_dist %>%
  get_p_value(obs_stat = obs_diff_movies, direction = "two_sided")

```

```{r}
CI <- movies_clean %>%
  group_by(director)%>%
  summarise(mean = mean(rating), SE = sd(rating)/sqrt(n()), t_critical = qt(0.975,n()-1),upper = mean + SE*t_critical, lower = mean -SE*t_critical)

ggplot(CI, aes(x=mean, y=reorder(director, mean)))+
  geom_point(aes(color = director, size = 1.7))+
  geom_rect(aes(xmin=max(lower), xmax=min(upper), ymin = -Inf, ymax = +Inf ,alpha = .3))+
  geom_errorbar(aes(xmin = lower , xmax = upper, width = 0.1, color = director, size = 1.5))+
  labs(title = "Do Spielberg and Burton have the same IMBD ratings?", subtitle = "95% confidence intervals overlap", y = "", x = "Mean IMBD Rating")+
  theme_bw()+
   geom_label(aes(y=reorder(director,mean),x=lower,
                   label = round(lower,2)),
                hjust=0.4, vjust=-0.4, fill = NA, label.size = NA)+
   geom_label(aes(y=reorder(director,mean),x=upper,
                   label = round(upper,2)),
                hjust=0.4, vjust=-0.4, fill = NA, label.size = NA)+
  theme(legend.position = "none")+
  geom_text(aes(label=round(mean,2), vjust =-2))
 
```
>We can reject the null hypothesis because the p value is below 0.05. Consequently Tim Burton and Steven Spielberg are 95% unlikely to have the same mean IBD rating.

# Omega Group plc- Pay Discrimination



## Loading the data


```{r load_omega_data}
omega <- read_csv(here::here("data", "omega.csv"))
glimpse(omega) # examine the data frame
```

## Relationship Salary - Gender ?



```{r, confint_single_valiables}
# Summary Statistics of salary by gender
mosaic::favstats (salary ~ gender, data=omega)

# Dataframe with two rows (male-female) and having as columns gender, mean, SD, sample size, 
# the t-critical value, the standard error, the margin of error, 
# and the low/high endpoints of a 95% condifence interval


summary_data <- omega %>%
  group_by(gender)%>%
  summarise(min = min(salary),  mean = mean(salary), max = max(salary), SD = sd(salary), sample_size = n(), t_critical = qt(0.975, sample_size-1), SE = SD/sqrt(sample_size), margin_of_error = t_critical*SE, lower = mean -t_critical * SE, upper = mean +SE*t_critical )

summary_data
```

>We can see from the table that the minimum, mean, and maximum salary of male executives are all higher than the ones for female executives. Moreover, the 95% confidence interval of female executives' salaries and the one of male executive's salaries do not overlap. We can therefore conclude in general, male executives earn more than female executives.


```{r, hypothesis_testing}
# hypothesis testing using t.test() 

t.test(salary ~ gender , data = omega)


# hypothesis testing using infer package

obs_diff_gender <- omega %>%
  specify(salary ~ gender) %>%
  calculate(stat = "diff in means", order = c("female", "male"))

null_dist <- omega %>%
  specify(salary ~ gender) %>%
  hypothesize(null = "independence") %>%
  generate(reps = 1000, type = "permute") %>%
  calculate(stat = "diff in means", order = c("female", "male")) # create null distribution

null_dist %>% visualize() +
  shade_p_value(obs_stat = obs_diff_gender, direction = "two-sided")

null_dist %>%
  get_p_value(obs_stat = obs_diff_gender, direction = "two_sided")

```

>We can draw a similar conclusion: There is a significant difference between the mean salary for female executives and the one for male executives. However, it does not necessarily mean gender is the only cause of this difference, and we would need further analysis to find out the reasons.

## Relationship Experience - Gender?


```{r, experience_stats}
# Summary Statistics of salary by gender
favstats (experience ~ gender, data=omega)

# hypothesis testing using t.test() 

t.test(experience ~ gender , data = omega)


# hypothesis testing using infer package

obs_diff_experience <- omega %>%
  specify(experience ~ gender) %>%
  calculate(stat = "diff in means", order = c("female", "male"))

null_dist <- omega %>%
  specify(experience ~ gender) %>%
  hypothesize(null = "independence") %>%
  generate(reps = 1000, type = "permute") %>%
  calculate(stat = "diff in means", order = c("female", "male")) # create null distribution

null_dist %>% visualize() +
  shade_p_value(obs_stat = obs_diff_experience, direction = "two-sided")

null_dist %>%
  get_p_value(obs_stat = obs_diff_experience, direction = "two_sided")


```


>There is a significant difference between the experience of the male and female executives. This conclusion might endanger our conclusion about the difference in male and female salary, since the reasons for the salary difference might lie around expierence instead of gender. We need to perform another analysis of the relationship between salary and experience to see the reasons behind the salary difference.

## Relationship Salary - Experience ?



```{r, salary_exp_scatter}
ggplot(omega, aes(y = salary, x = experience))+
  geom_point()+
  theme_bw()+
  labs(title = "Salary vs Experience", subtitle = "relationship between years of experience and salary", y = "Salary", x = "Years of experience")+
  geom_smooth()

```


## Check correlations between the data


```{r, ggpairs}
omega %>% 
  select(gender, experience, salary) %>% #order variables they will appear in ggpairs()
  ggpairs(aes(colour=gender, alpha = 0.3))+
  theme_bw()
```

>If we take experience into account, there are no significant difference in the salaries for female executives and male executives. In both groups, we can see that the executives with more experiences have higher pay. Thus, the difference between salary for women and men might be a result of the difference between experiences. 


# Challenge 1: Yield Curve inversion


```{r yield_curve_parable.jpg, echo=FALSE, out.width="100%"}
knitr::include_graphics(here::here("images", "yield_curve_parable.jpg"), error = FALSE)
```



```{r yield_curve_challenge, echo=FALSE, out.width="100%"}
knitr::include_graphics(here::here("images", "yield_curve_challenge.png"), error = FALSE)
```



 

```{r get_rates, warning=FALSE}
# Get a list of FRED codes for US rates and US yield curve; choose monthly frequency
# to see, eg., the 3-month T-bill https://fred.stlouisfed.org/series/TB3MS
tickers <- c('TB3MS', # 3-month Treasury bill (or T-bill)
             'TB6MS', # 6-month
             'GS1',   # 1-year
             'GS2',   # 2-year, etc....
             'GS3',
             'GS5',
             'GS7',
             'GS10',
             'GS20',
             'GS30')  #.... all the way to the 30-year rate

# Turn  FRED codes to human readable variables
myvars <- c('3-Month Treasury Bill',
            '6-Month Treasury Bill',
            '1-Year Treasury Rate',
            '2-Year Treasury Rate',
            '3-Year Treasury Rate',
            '5-Year Treasury Rate',
            '7-Year Treasury Rate',
            '10-Year Treasury Rate',
            '20-Year Treasury Rate',
            '30-Year Treasury Rate')

maturity <- c('3m', '6m', '1y', '2y','3y','5y','7y','10y','20y','30y')

# by default R will sort these maturities alphabetically; but since we want
# to keep them in that exact order, we recast maturity as a factor 
# or categorical variable, with the levels defined as we want
maturity <- factor(maturity, levels = maturity)

# Create a lookup dataset
mylookup<-data.frame(symbol=tickers,var=myvars, maturity=maturity)
# Take a look:
mylookup %>% 
  knitr::kable()

df <- tickers %>% tidyquant::tq_get(get="economic.data", 
                   from="1960-01-01")   # start from January 1960

glimpse(df)
```



```{r join_data, warning=FALSE}

yield_curve <-left_join(df,mylookup,by="symbol") 

```

```{r setup_US-recessions, warning=FALSE}

# get US recession dates after 1946 from Wikipedia 
# https://en.wikipedia.org/wiki/List_of_recessions_in_the_United_States

recessions <- tibble(
  from = c("1948-11-01", "1953-07-01", "1957-08-01", "1960-04-01", "1969-12-01", "1973-11-01", "1980-01-01","1981-07-01", "1990-07-01", "2001-03-01", "2007-12-01"),  
  to = c("1949-10-01", "1954-05-01", "1958-04-01", "1961-02-01", "1970-11-01", "1975-03-01", "1980-07-01", "1982-11-01", "1991-03-01", "2001-11-01", "2009-06-01") 
  )  %>% 
  mutate(From = ymd(from), 
         To=ymd(to),
         duration_days = To-From)

recessions
```

```{r}

threemonths <- yield_curve %>%
  filter(maturity=="3m")%>%
  select(date,price)
colnames(threemonths) <- c("date","priceTBills")

tenyears <- yield_curve %>%
  filter(maturity=="10y")%>%
  select(date,price)
colnames(tenyears) <- c("date","priceTeanYear")


diff <- merge(threemonths,tenyears)
diff <- diff %>%
  mutate(spread=priceTeanYear-priceTBills, minus_diff = ifelse(spread >= 0, spread, 0), plus_diff = ifelse(spread<0, spread, 0))

recessions$to <- as.Date(recessions$to)
recessions$from <- as.Date(recessions$from)
recessions_graph <- recessions %>%
  filter(to >= "1959/01/01")

ggplot(diff,aes(x=date, y=spread))+
  geom_line()+
  geom_hline(yintercept=0)+
  labs(title= "Yield Curve Inversion: 10-year minus 3-months US Treasury rates", subtitle = "Difference in % points, monthly averages.\nShaded areas correspond to recessions", caption = "Source: St. Louis Federeal Reserve Economic Database (FRED)", x="", y="Difference ( 10 year-3 month ) yield in %")+
  geom_rug(aes(colour=ifelse(spread>=0,">=0","<0")),sides="b")+
  scale_colour_manual(values=c("#eab5b7","#abc7e6"), guide=FALSE)+
  geom_ribbon(aes(ymin=0,ymax=minus_diff),fill="#abc7e6",alpha=0.6)+
  geom_ribbon(aes(ymin=0,ymax=plus_diff),fill="#eab5b7",alpha=0.6)+
  theme_minimal()+
  geom_rect(data=recessions_graph, inherit.aes=FALSE,
            aes(xmin=from,xmax=to,ymin=-Inf,ymax=Inf, alpha=0.2))+
  scale_x_date( breaks ="2 years",  date_labels = "%Y")+
  theme(legend.position = "none", text = element_text(size=7.3), plot.title = element_text(face="bold"))
```
## Plotting the yield curve



### Yields on US rates by duration since 1960

```{r yield_curve_1, echo=FALSE, out.width="100%"}
knitr::include_graphics(here::here("images", "yield_curve1.png"), error = FALSE)
```
```{r}
yield_curve$var = factor(yield_curve$var, myvars)

ggplot(yield_curve, aes(x=date , y = price, color = var))+
  geom_line()+
  theme_bw()+
  facet_wrap(~var, ncol = 2)+
  guides(color = FALSE)+
  labs(title= "Yields on U.S. Treasuries rates since 1960", x="", y="%", caption = "Source: St. Louis Federeal Reserve Economic Database (FRED)")+
  theme(text = element_text(size=8))
  

```

### Monthly yields on US rates by duration since 1999 on a year-by-year basis


```{r yield_curve_2, echo=FALSE, out.width="100%"}
knitr::include_graphics(here::here("images", "yield_curve2.png"), error = FALSE)
```

```{r}
graph2 <- yield_curve %>%
  filter(date>=as.Date("1999/01/01"))%>%
  mutate(year = format(date, "%Y"), month = format(date, "%m"))


ggplot(graph2, aes(x=maturity, group = month, color = year))+
  geom_line(aes(y=price))+
  theme_bw()+
  facet_wrap(~year, ncol = 4)+
  labs(title = "US Yield Curve", caption =  "Source: St. Louis Federeal Reserve Economic Database (FRED)", x="Maturity" , y="Yield (%)")+
  guides(color=FALSE)+
  theme(text = element_text(size = 9))

```


### 3-month and 10-year yields since 1999

```{r yield_curve_3, echo=FALSE, out.width="100%"}
knitr::include_graphics(here::here("images", "yield_curve3.png"), error = FALSE)
```
```{r}
graph3 <- yield_curve%>%
  filter(date>=as.Date("1999/01/01"), maturity == "10y"|maturity == "3m")

ggplot(graph3 , aes(x= date, y=price, color=var))+
  geom_line()+
  theme_bw()+
  labs(title= "Yields on 3-month and 10-year US Treasury rates since 1999", caption = "Source: St. Louis Federeal Reserve Economic Database (FRED)", x="", y="%")+
  theme(legend.title = element_blank(), text=element_text(size=8))


```


```{r setup_US-recession, warning=FALSE}

# get US recession dates after 1946 from Wikipedia 
# https://en.wikipedia.org/wiki/List_of_recessions_in_the_United_States

recessions <- tibble(
  from = c("1948-11-01", "1953-07-01", "1957-08-01", "1960-04-01", "1969-12-01", "1973-11-01", "1980-01-01","1981-07-01", "1990-07-01", "2001-03-01", "2007-12-01"),  
  to = c("1949-10-01", "1954-05-01", "1958-04-01", "1961-02-01", "1970-11-01", "1975-03-01", "1980-07-01", "1982-11-01", "1991-03-01", "2001-11-01", "2009-06-01") 
  )  %>% 
  mutate(From = ymd(from), 
         To=ymd(to),
         duration_days = To-From)

recessions
```




# Challenge 2:GDP components over time and among countries




```{r read_GDP_data}

library(readxl)

UN_GDP_data  <-  read_excel(here::here("data", "Download-GDPconstant-USD-countries.xls"), # Excel filename
                sheet="Download-GDPconstant-USD-countr", # Sheet name
                skip=2) # Number of rows to skip
glimpse(UN_GDP_data)
```

 


```{r reshape_GDP_data}

library(tidyr)
tidy_GDP_data  <-  UN_GDP_data %>% 
                     pivot_longer(cols=4:51,            #collapse years into 1 column
                                  names_to="year",
                                  values_to="value") %>% 
                     pivot_wider(names_from="IndicatorName",  #put indicators into columns to rename them
                                 values_from="value") 

tidy_GDP_data <- tidy_GDP_data %>%          #rename indicators
                  rename("Household expenditure" = "Household consumption expenditure (including Non-profit institutions serving households)",
                  "Government expenditure"="General government final consumption expenditure",
                  "Exports"="Exports of goods and services",
                  "Imports"="Imports of goods and services",
                  "Gross Capital Formation" = "Gross fixed capital formation (including Acquisitions less disposals of valuables)",
                  "Agriculture"="Agriculture, hunting, forestry, fishing (ISIC A-B)",
                  "Mining"="Mining, Manufacturing, Utilities (ISIC C-E)",
                  "Manufacturing"="Manufacturing (ISIC D)",
                  "Construction"="Construction (ISIC F)",
                  "Wholesale"="Wholesale, retail trade, restaurants and hotels (ISIC G-H)",
                  "Transport"="Transport, storage and communication (ISIC I)",
                  "Other"="Other Activities (ISIC J-P)",
                  "Inventory"="Changes in inventories")


tidy_GDP_data <- tidy_GDP_data %>%          #put indicators back in a single column
                  pivot_longer(cols=4:20,
                  names_to="IndicatorName",
                  values_to="value") 


tidy_GDP_data$value <- tidy_GDP_data$value/1e9   #express numbers in billions
                    

# Let us compare GDP components for these 3 countries
country_list <- c("United States","India", "Germany")
```




```{r gdp1, echo=FALSE, out.width="100%"}
knitr::include_graphics(here::here("images", "gdp1.png"), error = FALSE)
```
```{r}
indicatorlist <- c("Gross Capital Formation", "Exports", "Government expenditure", "Household expenditure", "Imports")

graph1 <- tidy_GDP_data %>%
  filter(Country %in% country_list & IndicatorName %in% indicatorlist)

ggplot(graph1, aes(x=year, y=value))+
  geom_line(aes(group = IndicatorName, color = IndicatorName))+
  facet_wrap(~Country, ncol = 3)+
  labs(title = "GDP Components over time", subtitle = "In constant 2010 USD", x= "", y = " Billions US$")+
  theme_bw()+
  scale_x_discrete(breaks=seq(1970, 2016, by = 10))+
  scale_color_discrete(name = "Components of GDP")

```



```{r}

GDP_calculate <- tidy_GDP_data %>%
   filter(IndicatorName %in% c("Gross Capital Formation", "Exports", "Government expenditure", "Household expenditure", "Imports", "Gross Domestic Product (GDP)")) %>% 
                   pivot_wider(names_from = "IndicatorName",
                               values_from = "value") %>% 
                   summarise(Country, year, GDP_calculated = `Household expenditure`+`Government expenditure`+`Gross Capital Formation`+`Exports`-`Imports`, percentage_difference = (GDP_calculated/`Gross Domestic Product (GDP)`-1)*100)

 graph4 <- GDP_calculate %>%
   group_by(year)%>%
   na.omit(percentage_difference)%>%
   summarise(mean_percentage_difference = mean(percentage_difference))
GDP_calculate

ggplot(graph4, aes(x = year , y = mean_percentage_difference))+
  geom_point()+
  labs(title = "Average % difference between Calculated GDP and GDP indicators", x ="", y="Mean % Difference")+
  theme_bw()+
  geom_hline(yintercept=0)+
  scale_x_discrete(breaks=seq(1970, 2016, by = 5))


summary_mean <- graph4 %>%
  summarise(mean = mean(mean_percentage_difference))

```


>On average, the % difference between what we calculated as GDP and the GDP figure included in the dataframe is -0.85.


```{r gdp2, echo=FALSE, out.width="100%"}
knitr::include_graphics(here::here("images", "gdp2.png"), error = FALSE)
```



>The household expenditure in United States increased drastically from 1970 to 2010. In United States other components of the GDP increased at a higher rate than India and Germany. In Germany, household consumption had a head start but as the time went by, other components of the GDP caught up with it. In India all components of the GDP seem to move together. 



# Details

- Who did you collaborate with: Ellie Tsao, Deniz Gokmen, Maximilien De Foresta, Pietro Gobbi, Yi Cao Cao 
- Approximately how much time did you spend on this problem set: 12 hours 
- What, if anything, gave you the most trouble: Answering % difference GDP question




